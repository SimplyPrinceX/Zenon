(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[547],{1469:(e,t,a)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),!function(e,t){for(var a in t)Object.defineProperty(e,a,{enumerable:!0,get:t[a]})}(t,{default:function(){return n},getImageProps:function(){return i}});let l=a(8229),r=a(8883),s=a(3063),o=l._(a(1193));function i(e){let{props:t}=(0,r.getImgProps)(e,{defaultLoader:o.default,imgConf:{deviceSizes:[640,750,828,1080,1200,1920,2048,3840],imageSizes:[16,32,48,64,96,128,256,384],path:"/_next/image",loader:"default",dangerouslyAllowSVG:!1,unoptimized:!1}});for(let[e,a]of Object.entries(t))void 0===a&&delete t[e];return{props:t}}let n=s.Image},5695:(e,t,a)=>{"use strict";var l=a(8999);a.o(l,"notFound")&&a.d(t,{notFound:function(){return l.notFound}}),a.o(l,"useParams")&&a.d(t,{useParams:function(){return l.useParams}}),a.o(l,"useRouter")&&a.d(t,{useRouter:function(){return l.useRouter}})},6018:(e,t,a)=>{Promise.resolve().then(a.bind(a,6065))},6065:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>c});var l=a(5155),r=a(2115),s=a(6766),o=a(5695);let i=a(9509).env.NEXT_PUBLIC_TMDB_API_KEY||"1070730380f5fee0d87cf0382670b255",n="https://api.themoviedb.org/3";function c(){let e=(0,o.useRouter)(),t=(0,o.useParams)(),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)("embedsu"),[p,h]=(0,r.useState)([]),[x,b]=(0,r.useState)(!1),[g,f]=(0,r.useState)(!1),[v,w]=(0,r.useState)({x:0,y:0}),[y,k]=(0,r.useState)([]),[j,N]=(0,r.useState)([]),[_,S]=(0,r.useState)(1),[C,E]=(0,r.useState)(1),[L,I]=(0,r.useState)(""),[A,F]=(0,r.useState)(!0),[T,P]=(0,r.useState)([]),[M,R]=(0,r.useState)(null),[D,O]=(0,r.useState)([]),[W,z]=(0,r.useState)(!1),B="string"==typeof t.type?t.type:Array.isArray(t.type)?t.type[0]:"",U="string"==typeof t.id?t.id:Array.isArray(t.id)?t.id[0]:"";if(console.log("Watch page params:",{type:B,id:U,params:t}),(0,r.useEffect)(()=>{a.e(522).then(a.bind(a,1522)).then(e=>{h(e.availableSources||[])})},[]),(0,r.useEffect)(()=>{U&&B&&e();async function e(){F(!0);let e=null;try{if(console.log("Fetching ".concat(B," with ID: ").concat(U)),"movie"===B){let t=await fetch("".concat(n,"/movie/").concat(U,"?api_key=").concat(i,"&append_to_response=credits,similar"));t.ok?(e=await t.json(),console.log("Movie data:",e)):console.log("Movie fetch failed:",t.status,t.statusText)}else if("tv"===B){let t=await fetch("".concat(n,"/tv/").concat(U,"?api_key=").concat(i,"&append_to_response=credits,similar"));t.ok?(e=await t.json(),console.log("TV data:",e)):console.log("TV fetch failed:",t.status,t.statusText)}else"anime"===B&&d(null);d(e),("tv"===B||"anime"===B)&&e&&e.number_of_seasons?(k(Array.from({length:e.number_of_seasons},(e,t)=>t+1)),S(1)):k([])}catch(e){console.error("Error fetching content:",e)}F(!1)}},[U,B]),(0,r.useEffect)(()=>{B&&c&&_&&e();async function e(){if("tv"===B&&c&&_){let e=await fetch("".concat(n,"/tv/").concat(U,"/season/").concat(_,"?api_key=").concat(i));e.ok&&(N(Array.from({length:(await e.json()).episodes.length},(e,t)=>t+1)),E(1))}else"anime"===B&&c?("Movie"===c.anime_type?N([1]):N(Array.from({length:c.total_episodes||12},(e,t)=>t+1)),E(1)):N([])}},[B,c,_,U]),(0,r.useEffect)(()=>{if(!c||0===p.length||!B||!U)return;let e=p.find(e=>e.id===u)||p[0],t="";if("movie"===B)t=e.urls.movie.replace("{id}",U);else if("tv"===B)t=e.urls.tv.replace("{id}",U).replace("{season}",String(_)).replace("{episode}",String(C));else if("anime"===B)if(c.tmdb_id)t=e.urls.tv.replace("{id}",c.tmdb_id.toString()).replace("{season}",String(_)).replace("{episode}",String(C));else{let e=p.find(e=>"vidsrccc"===e.id)||p[0];if(e){let a={16498:1429,38e3:85937,31964:65930,21:37854,20:46298,1:1399,269:1425,11061:46225,28851:37165,1530:1399,1575:1399,813:1399}[U]||null;t=a?e.urls.tv.replace("{id}",a.toString()).replace("{season}",String(_)).replace("{episode}",String(C)):e.urls.tv.replace("{id}",U).replace("{season}",String(_)).replace("{episode}",String(C))}}I(t)},[c,B,u,p,_,C,U]),(0,r.useEffect)(()=>{c&&B&&U&&e();async function e(){z(!0);let e=[];if("movie"===B){let t=await fetch("".concat(n,"/movie/").concat(U,"/similar?api_key=").concat(i));t.ok&&(e=(await t.json()).results||[])}else if("tv"===B){let t=await fetch("".concat(n,"/tv/").concat(U,"/similar?api_key=").concat(i));t.ok&&(e=(await t.json()).results||[])}else if("anime"===B)try{if(c&&c.title){console.log("Fetching anime recommendations from Enime...");let a=await fetch("".concat("https://api.consumet.org/anime/enime","/search?query=").concat(encodeURIComponent(c.title)));if(a.ok){var t;let l=await a.json();console.log("Enime recommendations received:",(null==(t=l.results)?void 0:t.length)||0,"items"),e=(l.results||[]).map(e=>({id:e.id,title:e.title,name:e.title,description:e.description,overview:e.description,poster_path:e.image,release_date:e.releaseDate,vote_average:e.rating}))}}}catch(e){console.error("Error fetching anime recommendations:",e)}O(e.slice(0,12)),z(!1)}},[B,U,c]),(0,r.useEffect)(()=>{let e=localStorage.getItem("watchLater");e&&P(JSON.parse(e))},[]),(0,r.useEffect)(()=>{localStorage.setItem("watchLater",JSON.stringify(T))},[T]),(0,r.useEffect)(()=>{if(!c&&!A&&B&&U){console.log("Content not found for ".concat(B,"/").concat(U,", trying fallback..."));let e="tv"===B?["movie"]:"movie"===B?["tv"]:[];(async()=>{for(let t of e)try{console.log("Trying fallback to ".concat(t,"..."));let e=await fetch("".concat(n,"/").concat(t,"/").concat(U,"?api_key=").concat(i,"&append_to_response=credits,similar"));if(e.ok){let a=await e.json();console.log("Fallback ".concat(t," data found:"),a),d(a),window.history.replaceState(null,"","/watch/".concat(t,"/").concat(U));break}}catch(e){console.log("Fallback ".concat(t," failed:"),e)}})()}},[c,A,B,U]),!B||!U)return(0,l.jsx)("div",{className:"p-8 text-center text-lg text-red-500",children:"Invalid URL: missing type or id."});let V=()=>T.some(e=>e.id===U&&e.type===B),J=()=>{c&&(V()?P(T.filter(e=>e.id!==U||"string"!=typeof e.type&&"number"!=typeof e.type||e.type!==B)):P([...T,{...c,id:U,type:String(B)}]))},X=()=>f(!1),Y=(e,t)=>{navigator.clipboard.writeText(e),R(t),setTimeout(()=>R(null),1200),X()},q="min-w-[180px] max-w-[180px] rounded-2xl bg-white/10 dark:bg-black/20 backdrop-blur-xl border border-white/20 dark:border-black/20 shadow-lg overflow-hidden hover:scale-105 hover:shadow-2xl transition cursor-pointer";return(0,l.jsxs)("div",{className:"max-w-7xl mx-auto px-2 sm:px-6 lg:px-8 py-6",children:[(0,l.jsx)("div",{className:"relative rounded-3xl overflow-hidden mb-8 shadow-2xl border border-white/20 dark:border-black/20 backdrop-blur-2xl bg-white/10 dark:bg-black/20",children:(0,l.jsx)("div",{className:"aspect-video w-full bg-black/80 flex items-center justify-center",onContextMenu:e=>{e.preventDefault(),f(!0),w({x:e.clientX,y:e.clientY})},children:L?(0,l.jsx)("iframe",{src:L,allowFullScreen:!0,className:"w-full h-full rounded-3xl border-none",style:{minHeight:320}}):(0,l.jsx)("span",{className:"text-white/60",children:"Player loading..."})})}),(0,l.jsx)("div",{className:"rounded-3xl glass-card mb-8 p-6",children:A?(0,l.jsx)("div",{className:"text-white/70",children:"Loading..."}):c?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("h1",{className:"text-3xl font-extrabold text-white drop-shadow-lg mb-2",children:c.title||c.name}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 items-center mb-2",children:[c.release_date&&(0,l.jsx)("span",{className:"text-white/80 font-semibold",children:(c.release_date||c.first_air_date||"").slice(0,4)}),c.vote_average&&(0,l.jsxs)("span",{className:"text-yellow-400 font-bold",children:["⭐ ",c.vote_average.toFixed(1)]}),c.genres&&c.genres.map(e=>(0,l.jsx)("span",{className:"px-2 py-1 rounded-full bg-white/20 text-white/80 text-xs font-medium",children:e.name},e.id))]}),(0,l.jsx)("p",{className:"text-lg text-white/90 max-w-xl drop-shadow mb-2",children:c.overview||c.description})]}):(0,l.jsx)("div",{className:"text-white/70",children:"Not found."})}),(0,l.jsxs)("div",{className:"flex flex-wrap gap-4 mb-8 items-center",children:[(0,l.jsx)("select",{value:u,onChange:e=>m(e.target.value),className:"glass-toggle px-4 py-2 rounded-lg border border-white/20 dark:border-black/20 backdrop-blur-md bg-white/10 dark:bg-black/20 text-white font-semibold",children:p.map(e=>(0,l.jsx)("option",{value:e.id,children:e.name},e.id))}),"tv"===B&&y.length>0&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("select",{value:_,onChange:e=>S(Number(e.target.value)),className:"glass-toggle px-4 py-2 rounded-lg border border-white/20 dark:border-black/20 backdrop-blur-md bg-white/10 dark:bg-black/20 text-white font-semibold",children:y.map(e=>(0,l.jsxs)("option",{value:e,children:["Season ",e]},e))}),(0,l.jsx)("select",{value:C,onChange:e=>E(Number(e.target.value)),className:"glass-toggle px-4 py-2 rounded-lg border border-white/20 dark:border-black/20 backdrop-blur-md bg-white/10 dark:bg-black/20 text-white font-semibold",children:j.map(e=>(0,l.jsxs)("option",{value:e,children:["Ep ",e]},e))})]}),(0,l.jsx)("button",{className:"glass-toggle px-4 py-2 rounded-lg border border-white/20 dark:border-black/20 backdrop-blur-md bg-white/10 dark:bg-black/20 text-white font-semibold ".concat(V()?"bg-purple-600":""),onClick:J,children:V()?"Remove from Watch Later":"Add to Watch Later"}),(0,l.jsx)("button",{className:"glass-toggle px-4 py-2 rounded-lg border border-white/20 dark:border-black/20 backdrop-blur-md bg-white/10 dark:bg-black/20 text-white font-semibold",onClick:()=>b(!0),children:"Show Watch Later"})]}),(0,l.jsxs)("div",{className:"mt-8",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-3 text-white drop-shadow-lg",children:"Similar Content"}),(0,l.jsx)("div",{className:"flex gap-5 overflow-x-auto pb-2 scrollbar-thin scrollbar-thumb-cyan-400/30 scrollbar-track-transparent",children:W?(0,l.jsx)("div",{className:"text-white/60 py-8",children:"Loading..."}):0===D.length?(0,l.jsx)("div",{className:"text-white/60 py-8",children:"No similar content found."}):D.map(t=>{var a,r,o;return(0,l.jsxs)("div",{className:q,onClick:()=>e.push("/watch/".concat(t.id)),title:t.title||t.name,children:[t.poster_path?(0,l.jsx)(s.default,{src:"https://image.tmdb.org/t/p/w300".concat(t.poster_path||""),alt:t.title||t.name||"",width:180,height:260,className:"object-cover w-full h-[260px]"}):(0,l.jsx)("div",{className:"w-full h-[260px] flex items-center justify-center text-white/40 bg-black/30",children:"No Image"}),(0,l.jsx)("div",{className:"p-2 text-white font-semibold text-center bg-gradient-to-t from-black/60 to-transparent",children:t.title||t.name}),(0,l.jsxs)("div",{className:"text-yellow-400 text-xs text-center pb-2",children:["⭐ ",(null==(a=t.vote_average)?void 0:a.toFixed(1))||"N/A"]})]},"".concat(String(null!=(r=t.id)?r:""),"-").concat(String(null!=(o=null==t?void 0:t.media_type)?o:B)))})})]}),x&&(0,l.jsx)("div",{className:"fixed inset-0 z-50 bg-black/70 flex items-center justify-center",children:(0,l.jsxs)("div",{className:"rounded-2xl bg-white/20 dark:bg-black/30 backdrop-blur-xl p-8 shadow-2xl border border-white/20 max-w-lg w-full",children:[(0,l.jsx)("h2",{className:"text-2xl font-bold mb-4 text-white",children:"Watch Later List"}),0===T.length?(0,l.jsx)("div",{className:"text-white/70 text-center py-8",children:"No items in your watch later list."}):(0,l.jsx)("div",{className:"grid grid-cols-2 gap-4",children:T.map(e=>{var t;let a="string"==typeof e.id||"number"==typeof e.id?String(e.id):"",r="string"==typeof e.type||"number"==typeof e.type?String(e.type):"";return(0,l.jsxs)("div",{className:q+" p-2 flex flex-col items-center",children:[e.poster_path&&(0,l.jsx)(s.default,{src:"https://image.tmdb.org/t/p/w300".concat(e.poster_path||""),alt:e.title||"",width:80,height:120,className:"rounded mb-2"}),(0,l.jsx)("div",{className:"text-white text-sm font-semibold text-center mb-1",children:e.title}),(0,l.jsxs)("div",{className:"text-yellow-400 text-xs",children:["⭐ ",(null==(t=e.vote_average)?void 0:t.toFixed(1))||"N/A"]}),(0,l.jsx)("button",{className:"mt-2 px-2 py-1 rounded bg-purple-600 text-white text-xs",onClick:()=>{P(T.filter(t=>t.id!==e.id||"string"!=typeof t.type&&"number"!=typeof t.type||t.type!==e.type))},children:"Remove"})]},"".concat(a,"-").concat(r))})}),(0,l.jsx)("button",{onClick:()=>b(!1),className:"mt-6 px-4 py-2 rounded-lg bg-purple-600 text-white w-full",children:"Close"})]})}),g&&(0,l.jsxs)("div",{style:{left:v.x,top:v.y,position:"fixed",zIndex:100},className:"rounded-xl bg-white/20 dark:bg-black/30 backdrop-blur-xl shadow-lg border border-white/20 p-4 min-w-[180px]",onMouseLeave:X,children:[(0,l.jsx)("button",{className:"block w-full text-left text-white py-1 hover:bg-white/10 rounded",onClick:()=>Y((null==c?void 0:c.title)||(null==c?void 0:c.name)||"","Title"),children:"Copy Title"}),(0,l.jsx)("button",{className:"block w-full text-left text-white py-1 hover:bg-white/10 rounded",onClick:()=>Y(U,"TMDB ID"),children:"Copy TMDB ID"}),(0,l.jsx)("button",{className:"block w-full text-left text-white py-1 hover:bg-white/10 rounded",onClick:()=>{J(),X()},children:V()?"Remove from Watch Later":"Add to Watch Later"}),M&&(0,l.jsxs)("div",{className:"text-xs text-green-300 mt-2",children:["Copied ",M,"!"]})]})]})}},6766:(e,t,a)=>{"use strict";a.d(t,{default:()=>r.a});var l=a(1469),r=a.n(l)}},e=>{e.O(0,[63,441,964,358],()=>e(e.s=6018)),_N_E=e.O()}]);